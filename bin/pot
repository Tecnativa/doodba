#!/bin/bash
# Shortcut to run Odoo in unit testing mode
set -e
addons=$1
shift
languages=$1
shift
log INFO Executing Odoo in i18n export mode with languages $languages for addons $addons
set -x
for l in $(echo $languages | tr "," "\n")
do
    for i in $(echo $addons | tr "," "\n")
    do
        if [ -d /opt/odoo/auto/addons/$i ]
        then
            mkdir -p /opt/odoo/auto/addons/$i/i18n && odoo --stop-after-init -d "$PGDATABASE" \
                --language $l --i18n-export /opt/odoo/auto/addons/$i/i18n/${l}.po \
                --modules "$i" --update "$i" --workers 0 "$@"
        fi
    done
done
